+function(c){var d=function(f,e){this.$element=c(f);this.options=c.extend({},d.DEFAULTS,e);this.init()};d.VERSION="1.0.0";d.DEFAULTS={height:"120px",width:"120px",maximumSelectionLength:0,imageHeight:"100%",imageWidth:"100%"};d.prototype.loadKindEditor=function(g){var e=this.options;var f=this.kindEditor;if(!f){f=KindEditor.editor({uploadJson:Util.smartParseURL(Config.getFileUploadUrl()),allowFileManager:false,formatUploadUrl:false});this.kindEditor=f}f.loadPlugin("image",function(){f.plugin.imageDialog({showRemote:false,clickFn:g})})};d.prototype.init=function(){var e=this.$element;var f=this.options;var h=this;e.wrap('<div class="input-group"></div>');var i=[];i.push('<div class="input-group-btn">');i.push('  <button type="button" class="btn default btn-upload" tabindex="-1">');i.push("    上传文件");i.push("  </button>");i.push('  <button type="button" class="btn default dropdown-toggle" data-toggle="dropdown" tabindex="-1">');i.push('    <i class="fa fa-angle-down"></i>');i.push("  </button>");i.push('  <ul class="dropdown-menu pull-right" role="menu">');i.push("    <li>");i.push('      <a href="javascript:;" target="_blank" class="btn-download"> 查看/下载文件 </a>');i.push("    </li>");i.push("    <li>");i.push('      <a href="javascript:;" target="_blank" class="btn-clear"> 清空输入框 </a>');i.push("    </li>");i.push("  </ul>");i.push("</div>");var g=c(i.join(""));e.after(g);g.on("click",".btn-upload",function(){h.loadKindEditor(function(j){e.val(j);h.kindEditor.hideDialog()})});g.on("click",".btn-download",function(){var k=c(this);var j=e.val();if(j&&j!=""){k.attr("href",j)}else{k.attr("href","javascript:;")}});g.on("click",".btn-clear",function(){e.val("")})};function b(e){return this.each(function(){var h=c(this);var g=h.data("ExtFileUploader");var f=typeof e=="object"&&e;if(!g){h.data("ExtFileUploader",(g=new d(this,f)))}if(typeof e=="string"){g[e]()}})}var a=c.fn.extFileUploader;c.fn.extFileUploader=b;c.fn.extFileUploader.Constructor=d;c.fn.extFileUploader.noConflict=function(){c.fn.extFileUploader=a;return this};Global.addComponent({name:"ExtFileUploader",plugin:b,runPoint:Global.Component_Run_Point.BeforeAjaxPageShow,expr:"input[data-fileuploader]"})}(jQuery);