+function(d){var c=function(f,e){this.$element=d(f);this.options=d.extend({},c.DEFAULTS,e);this.init()};c.VERSION="1.0.0";c.DEFAULTS={rowFormElementsExpr:"input,select,textarea"};c.resetInputAttrNameIndex=function(g,f,e){var h=g.attr(f);if(h){var i=h.substring(0,h.indexOf("[")+1)+e+h.substring(h.indexOf("]"),h.length);g.attr(f,i)}};c.prototype.init=function(){var i=this;var g=this.$element;var h=this.options;var f=g.children("tbody");var l='<button type="button" class="btn btn-xs btn-circle default btn-row-remove" title="删除当前行项" style="padding: 0px 8px;margin-right: 5px">  <i class="fa fa-minus"></i>  </button>';g.on("click",".btn-row-remove",function(o){var n=d(o.target);var m=n.closest("tr");if(h.ruleMinlength){if(f.children("tr").size()==h.ruleMinlength){alert("至少需要保留 "+h.ruleMinlength+" 条行项数据")}else{m.remove();i.rebuildRowsOperation()}}else{m.remove();i.rebuildRowsOperation()}});var k=g.find(" > thead > tr");k.prepend("<th>序号</th>");k.prepend('<th><button type="button" class="btn btn-xs btn-circle yellow btn-row-add" title="添加新行项" style="padding: 0px 8px;margin-right: 5px">  <i class="fa fa-plus"></i>  </button></th>');k.find(".btn-row-add").on("click",function(){var m=d("<tr>"+i.templateRowHTML+"</tr>");f.append(m);m.find(h.rowFormElementsExpr).each(function(){var n=d(this);n.attr("id",App.getUniqueID("row_el_"))});i.rebuildRowsOperation();Global.runComponents(Global.Component_Run_Point.BeforeAjaxPageShow,m);Global.runComponents(Global.Component_Run_Point.AfterAjaxPageShow,m);g.closest("form").attr("form-data-modified","true")});var e=f.children("tr");e.each(function(n){var m=d(this);m.addClass("dynamic-edit-row");m.prepend('<td class="row-num" style="min-width: 50px;padding-top: 17px;text-align: center"><span class="row-num">'+(n+1)+"</span></td>");m.prepend('<td class="row-operations" style="min-width: 30px;padding-top: 17px;">'+l+"</td>")});i.rebuildRowsOperation();var j=g.find(" > tbody > tr:last");this.templateRowHTML=j.html();if(h.ruleMinlength==undefined||e.size()>1){j.remove()}};c.prototype.rebuildRowsOperation=function(){var i=this;var g=this.$element;var h=this.options;var f=g.children("tbody");var e=f.children("tr");e.each(function(k){var j=d(this);j.find("span.row-num").html((k+1));j.find(h.rowFormElementsExpr).each(function(){var l=d(this);c.resetInputAttrNameIndex(l,"name",k);c.resetInputAttrNameIndex(l,"data-cascade-name",k);c.resetInputAttrNameIndex(l,"data-cascade-parent",k);c.resetInputAttrNameIndex(l,"data-rule-dateLT",k);c.resetInputAttrNameIndex(l,"data-rule-dateGT",k)})})};function b(e){return this.each(function(){var h=d(this);var g=h.data("extDynamicEditTable");var f=typeof e=="object"&&e;if(!g){h.data("extDynamicEditTable",(g=new c(this,f)))}if(typeof e=="string"){g[e]()}})}var a=d.fn.extDynamicEditTable;d.fn.extDynamicEditTable=b;d.fn.extDynamicEditTable.Constructor=c;d.fn.extDynamicEditTable.noConflict=function(){d.fn.extDynamicEditTable=a;return this};Global.addComponent({name:"ExtDynamicEditTable",plugin:b,expr:"table[data-dynamic-edit-table]",order:1000})}(jQuery);