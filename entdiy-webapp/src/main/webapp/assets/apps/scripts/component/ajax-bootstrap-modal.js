+function(d){var b=function(f,e){this.$element=d(f);this.options=d.extend({},b.DEFAULTS,e);this.init()};b.VERSION="1.0.0";b.DEFAULTS={modalOverflow:true,width:"500px",forceReload:false,maxHeight:function(){return d(window).height()-70}};b.prototype.init=function(){var g=this;var f=this.options;var e=this.$element;if(f.url){e.on("click",function(){g.show()})}};b.prototype.show=function(f){var e=this.$element;f=d.extend({},this.options,f);if(!this.$dialog){if(f.title==undefined){f.title=e.attr("title")}if(f.title==undefined){f.title="对话框"}var g=[];g.push('<div class="modal fade" tabindex="-1" style="display: none;" >');g.push('    <div class="modal-content">');g.push('      <div class="modal-header">');g.push('        <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" title="关闭对话框"></button>');g.push('        <button type="button" class="close btn-reload" title="刷新对话框"></button>');g.push('        <h4 class="modal-title">'+f.title+"</h4>");g.push("      </div>");g.push('      <div class="modal-body modal-ajaxify-body form"></div>');g.push('      <div class="modal-footer hide">');g.push('        <button type="button" class="btn default" data-dismiss="modal">关闭窗口</button>');g.push("      </div>");g.push("    </div>");g.push("</div>");var h=d(g.join(""));e.after(h);this.$dialog=h;h.data("newUrl",f.url);h.on("show",function(){var i=h.data("lastUrl");var l=h.data("newUrl");if(f.forceReload||!i||i!=l){var j=Util.smartParseURL(l);var k=h.find(".modal-ajaxify-body");k.ajaxGetUrl(j)}h.data("lastUrl",l);h.attr("dismiss-confirmed",false)});h.modal(f);h.draggable({handle:".modal-header",cancel:".modal-header > button",scroll:false});h.find(".modal-header > .btn-reload").click(function(){var i=Util.smartParseURL(f.url);h.find(".modal-ajaxify-body").ajaxGetUrl(i)});h.on("hide",function(j){var i=j.srcElement?j.srcElement:j.target;if(d(i).is("[data-picker]")){return}if(h.attr("dismiss-confirmed")==undefined||h.attr("dismiss-confirmed")=="false"){h.find("form[method='post']:not(.form-track-disabled)[form-data-modified='true']:first").each(function(){var k=d(this);if(confirm("当前表单有修改数据未保存，确认离开当前表单吗？")){h.attr("dismiss-confirmed",true);k.attr("form-data-modified",false)}else{h.attr("dismiss-confirmed",false);j.stopPropagation();j.preventDefault();return false}})}})}else{this.$dialog.data("newUrl",f.url);this.$dialog.modal(f)}};function c(f){var e=arguments;return this.each(function(){var i=d(this);var h=i.data("ExtAjaxBootstrapModal");var g=typeof f=="object"&&f;if(!h){i.data("ExtAjaxBootstrapModal",(h=new b(this,g)))}if(typeof f=="string"){h[f].apply(h,d.makeArray(e).slice(1))}})}var a=d.fn.extAjaxBootstrapModal;d.fn.extAjaxBootstrapModal=c;d.fn.extAjaxBootstrapModal.Constructor=b;d.fn.extAjaxBootstrapModal.noConflict=function(){d.fn.extAjaxBootstrapModal=a;return this};Global.addComponent({name:"ExtAjaxBootstrapModal",plugin:c,expr:'a[data-toggle="modal-ajaxify"],a[target="modal-ajaxify"]'})}(jQuery);