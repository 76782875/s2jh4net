+function(d){var b=function(f,e){this.$element=d(f);this.options=d.extend({},b.DEFAULTS,e);this.init()};b.VERSION="1.0.0";b.DEFAULTS={width:"500px",forceReload:false,maxHeight:function(){return d(window).height()-165}};b.prototype.init=function(){var g=this;var f=this.options;var e=this.$element;if(f.url){e.on("click",function(){g.show()})}};b.prototype.show=function(g){var e=this.$element;g=d.extend({},this.options,g);if(!this.$dialog){if(g.title==undefined){g.title=e.attr("title")}if(g.title==undefined){g.title="对话框"}var h=[];h.push('<div class="modal fade" tabindex="-1" style="display: none;" >');h.push('    <div class="modal-content">');h.push('      <div class="modal-header">');h.push('        <button type="button" class="close"  data-dismiss="modal" aria-hidden="true" title="关闭对话框"></button>');h.push('        <button type="button" class="close btn-reload" title="刷新对话框"></button>');h.push('        <h4 class="modal-title">'+g.title+"</h4>");h.push("      </div>");h.push('      <div class="modal-body modal-ajaxify-body form"></div>');h.push('      <div class="modal-footer hide">');h.push('        <button type="button" class="btn default" data-dismiss="modal">关闭窗口</button>');h.push("      </div>");h.push("    </div>");h.push("</div>");var i=d(h.join(""));e.after(i);this.$dialog=i}var i=this.$dialog;var j=i.find(".modal-ajaxify-body");if(j.is(":empty")){i.draggable({handle:".modal-header",cancel:".modal-header > button",scroll:false});i.find(".modal-header > .btn-reload").click(function(){var k=Util.smartParseURL(g.url);i.find(".modal-ajaxify-body").ajaxGetUrl(k)});i.on("show",function(){i.attr("dismiss-confirmed",false)});i.on("hide",function(l){var k=l.srcElement?l.srcElement:l.target;if(d(k).is("[data-picker]")){return}if(i.attr("dismiss-confirmed")==undefined||i.attr("dismiss-confirmed")=="false"){i.find("form[method='post']:not(.form-track-disabled)[form-data-modified='true']").each(function(){var m=d(this);if(confirm("当前表单有修改数据未保存，确认离开当前表单吗？")){i.attr("dismiss-confirmed",true);m.attr("form-data-modified",false)}else{i.attr("dismiss-confirmed",false);l.stopPropagation();l.preventDefault();return false}})}})}i.modal(g);if(g.forceReload||!this.lastUrl||this.lastUrl!=g.url){this.lastUrl=g.url;var f=Util.smartParseURL(g.url);i.find(".modal-ajaxify-body").ajaxGetUrl(f)}};function c(f){var e=arguments;return this.each(function(){var i=d(this);var h=i.data("ExtAjaxBootstrapModal");var g=typeof f=="object"&&f;if(!h){i.data("ExtAjaxBootstrapModal",(h=new b(this,g)))}if(typeof f=="string"){h[f].apply(h,d.makeArray(e).slice(1))}})}var a=d.fn.extAjaxBootstrapModal;d.fn.extAjaxBootstrapModal=c;d.fn.extAjaxBootstrapModal.Constructor=b;d.fn.extAjaxBootstrapModal.noConflict=function(){d.fn.extAjaxBootstrapModal=a;return this};Global.addComponent({name:"ExtAjaxBootstrapModal",plugin:c,expr:'a[data-toggle="modal-ajaxify"],a[target="modal-ajaxify"]'})}(jQuery);