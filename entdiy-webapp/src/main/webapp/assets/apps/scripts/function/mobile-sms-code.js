+function(c){function b(){Util.assert(c.fn.extImageCaptchaCode,"依赖组件 extMobileSmsCode 未引入");c("body").on("click","button.btn-send-sms-code,a.btn-send-sms-code",function(){var g;var f=c(this);if(f.attr("disabled")){return}var d=f.closest("form").find("input[name='"+f.attr("data-mobile-el")+"']");if(d.valid()){var e=f.extPopupCaptchaCode({callbackVal:function(i){f.attr("disabled",true);f.html("正在发送...");f.closest(".form-group").find(":text:first").focus().select();var h=f.attr("data-open");c.ajax({url:WEB_ROOT+"/pub/send-sms-code/"+d.val()+"?captcha="+i,dataType:"json",method:"get",success:function(j){if(j.type=="success"){e.extPopupCaptchaCode("hide");f.html("<i>已发送<span class='small'>(<span class='count'> 60 </span>秒后可重发)</span></i>");g=setInterval(function(){var k=f.find(".count").html();if(k<=0){f.attr("disabled",false);f.html("获取验证码");clearInterval(g)}else{k=Number(k)-1;f.html("<i>已发送<span class='small'>(<span class='count'> "+k+" </span>秒后可重发)</span></i>")}},1000)}else{e.extPopupCaptchaCode("refresh");Global.notify("warning",j.message);f.attr("disabled",false);f.html("获取验证码")}}});return false}});f.extPopupCaptchaCode("show")}})}var a=c.fn.extMobileSmsCode;c.fn.extMobileSmsCode=b;c.fn.extMobileSmsCode.noConflict=function(){c.fn.extMobileSmsCode=a;return this};c(document).ready(function(){Util.debug("Adding and init plugin ExtMobileSmsCode");b()})}(jQuery);